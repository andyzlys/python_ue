import pandas as pd

def excel_to_dicts(excel_file_path):
    """
    Reads an Excel file and converts each column (except the first one) into a dictionary.
    The keys for the dictionaries are taken from the first column of the Excel sheet.

    Args:
    - excel_file_path (str): The path to the Excel file to be read.

    Returns:
    - dict of dict: A dictionary containing dictionaries for each column in the Excel sheet.
    """
    # Read the Excel file
    df = pd.read_excel(excel_file_path, header=0)  # Assuming the first row is the header

    # Initialize a dictionary to hold the column dictionaries
    column_dicts = {}

    # Loop through each column in the dataframe, skipping the first one
    for col in df.columns[1:]:
        # Convert the column to a dictionary with the first column as keys
        column_dicts[col] = pd.Series(df[col].values, index=df[df.columns[0]]).to_dict()

    # Replace NaN values with None in the dictionaries
    for column_dict in column_dicts.values():
        for key, value in column_dict.items():
            if pd.isna(value):
                column_dict[key] = None

    return column_dicts

# Usage example (you should replace the 'excel_file_path' with your actual file path):
# dictionaries = excel_to_dictionaries('/path/to/your/excel/file.xlsx')
if __name__ == '__main__':
    excel_file_path = r'./ik_bones_rename.xlsx'
    column_dicts = excel_to_dicts(excel_file_path)
    print(column_dicts['mixamo_xiaobairen'])

# mixamo_xiaobairen = {'root': None, 'pelvis': 'Hips', 'spine_01': 'Spine', 'spine_02': 'Spine1', 'spine_03': 'Spine2', 'spine_04': None, 'spine_05': None, 'neck_01': 'Neck', 'neck_02': None, 'head': 'Head', nan: 'RightHandThumb4', 'clavicle_l': 'LeftShoulder', 'clavicle_out_l': None, 'clavicle_scap_l': None, 'upperarm_l': 'LeftArm', 'lowerarm_l': 'LeftForeArm', 'hand_l': 'LeftHand', 'index_metacarpal_l': 'LeftHandIndex1', 'index_01_l': 'LeftHandIndex2', 'index_01_bulge_l': None, 'index_01_half_l': None, 'index_01_mcp_l': None, 'index_01_palm_l': None, 'index_01_palmMid_l': None, 'index_01_side_inn_l': None, 'index_01_side_out_l': None, 'index_02_l': 'LeftHandIndex3', 'index_02_bulge_l': None, 'index_02_half_l': None, 'index_02_in_l': None, 'index_02_pip_l': None, 'index_02_side_inn_l': None, 'index_02_side_out_l': None, 'index_03_l': 'LeftHandIndex4', 'index_03_bulge_l': None, 'index_03_half_l': None, 'index_02_dip_l': None, 'index_03_in_l': None, 'index_metacarpal_slide_l': None, 'middle_metacarpal_l': 'LeftHandMiddle1', 'middle_01_l': 'LeftHandMiddle2', 'middle_01_bulge_l': None, 'middle_01_half_l': None, 'middle_01_mcp_l': None, 'middle_01_palm_l': None, 'middle_01_palmMid_l': None, 'middle_01_side_inn_l': None, 'middle_01_side_out_l': None, 'middle_02_l': 'LeftHandMiddle3', 'middle_02_bulge_l': None, 'middle_02_half_l': None, 'middle_02_in_l': None, 'middle_02_pip_l': None, 'middle_02_side_inn_l': None, 'middle_02_side_out_l': None, 'middle_03_l': 'LeftHandMiddle4', 'middle_03_bulge_l': None, 'middle_03_half_l': None, 'middle_02_dip_l': None, 'middle_03_in_l': None, 'middle_metacarpal_slide_l': None, 'pinky_metacarpal_l': 'LeftHandPinky1', 'pinky_01_l': 'LeftHandPinky2', 'pinky_01_bulge_l': None, 'pinky_01_half_l': None, 'pinky_01_mcp_l': None, 'pinky_01_palm_l': None, 'pinky_01_palmMid_l': None, 'pinky_01_side_inn_l': None, 'pinky_01_side_out_l': None, 'pinky_02_l': 'LeftHandPinky3', 'pinky_02_bulge_l': None, 'pinky_02_half_l': None, 'pinky_02_in_l': None, 'pinky_02_pip_l': None, 'pinky_02_side_inn_l': None, 'pinky_02_side_out_l': None, 'pinky_03_l': 'LeftHandPinky4', 'pinky_03_bulge_l': None, 'pinky_03_half_l': None, 'pinky_02_dip_l': None, 'pinky_03_in_l': None, 'pinky_metacarpal_slide_l': None, 'ring_metacarpal_l': 'LeftHandRing1', 'ring_01_l': 'LeftHandRing2', 'ring_01_bulge_l': None, 'ring_01_half_l': None, 'ring_01_mcp_l': None, 'ring_01_palm_l': None, 'ring_01_palmMid_l': None, 'ring_01_side_inn_l': None, 'ring_01_side_out_l': None, 'ring_02_l': 'LeftHandRing3', 'ring_02_bulge_l': None, 'ring_02_half_l': None, 'ring_02_in_l': None, 'ring_02_pip_l': None, 'ring_02_side_inn_l': None, 'ring_02_side_out_l': None, 'ring_03_l': 'LeftHandRing4', 'ring_03_bulge_l': None, 'ring_03_half_l': None, 'ring_02_dip_l': None, 'ring_03_in_l': None, 'ring_metacarpal_slide_l': None, 'thumb_01_l': 'LeftHandThumb1', 'thumb_01_side_inn_l': None, 'thumb_01_side_out_l': None, 'thumb_02_l': 'LeftHandThumb2', 'thumb_02_bulge_l': None, 'thumb_02_half_l': None, 'thumb_02_in_l': None, 'thumb_02_mcp_l': None, 'thumb_02_side_inn_l': None, 'thumb_02_side_out_l': None, 'thumb_03_l': 'LeftHandThumb3', 'thumb_03_bulge_l': None, 'thumb_03_half_l': None, 'thumb_03_in_l': None, 'thumb_03_pip_l': None, 'thumb_03_side_inn_l': None, 'thumb_03_side_out_l': None, 'wrist_inner_l': None, 'wrist_outer_l': None, 'lowerarm_correctiveRoot_l': None, 'lowerarm_bck_l': None, 'lowerarm_fwd_l': None, 'lowerarm_in_l': None, 'lowerarm_out_l': None, 'lowerarm_twist_01_l': None, 'lowerarm_twist_02_l': None, 'upperarm_correctiveRoot_l': None, 'upperarm_bck_l': None, 'upperarm_fwd_l': None, 'upperarm_in_l': None, 'upperarm_out_l': None, 'upperarm_twist_01_l': None, 'upperarm_twistCor_01_l': None, 'upperarm_twist_02_l': None, 'upperarm_bicep_l': None, 'upperarm_tricep_l': None, 'upperarm_twistCor_02_l': None, 'clavicle_pec_l': None, 'clavicle_pec_r': None, 'clavicle_r': 'RightShoulder', 'clavicle_out_r': None, 'clavicle_scap_r': None, 'upperarm_r': 'RightArm', 'lowerarm_r': 'RightForeArm', 'hand_r': 'RightHand', 'index_metacarpal_r': 'RightHandIndex1', 'index_01_r': 'RightHandIndex2', 'index_01_bulge_r': None, 'index_01_half_r': None, 'index_01_mcp_r': None, 'index_01_palm_r': None, 'index_01_palmMid_r': None, 'index_01_side_inn_r': None, 'index_01_side_out_r': None, 'index_02_r': 'RightHandIndex3', 'index_02_bulge_r': None, 'index_02_half_r': None, 'index_02_in_r': None, 'index_02_pip_r': None, 'index_02_side_inn_r': None, 'index_02_side_out_r': None, 'index_03_r': 'RightHandIndex4', 'index_03_bulge_r': None, 'index_03_half_r': None, 'index_02_dip_r': None, 'index_03_in_r': None, 'index_metacarpal_slide_r': None, 'middle_metacarpal_r': 'RightHandMiddle1', 'middle_01_r': 'RightHandMiddle2', 'middle_01_bulge_r': None, 'middle_01_half_r': None, 'middle_01_mcp_r': None, 'middle_01_palm_r': None, 'middle_01_palmMid_r': None, 'middle_01_side_inn_r': None, 'middle_01_side_out_r': None, 'middle_02_r': 'RightHandMiddle3', 'middle_02_bulge_r': None, 'middle_02_half_r': None, 'middle_02_in_r': None, 'middle_02_pip_r': None, 'middle_02_side_inn_r': None, 'middle_02_side_out_r': None, 'middle_03_r': 'RightHandMiddle4', 'middle_03_bulge_r': None, 'middle_03_half_r': None, 'middle_02_dip_r': None, 'middle_03_in_r': None, 'middle_metacarpal_slide_r': None, 'pinky_metacarpal_r': 'RightHandPinky1', 'pinky_01_r': 'RightHandPinky2', 'pinky_01_bulge_r': None, 'pinky_01_half_r': None, 'pinky_01_mcp_r': None, 'pinky_01_palm_r': None, 'pinky_01_palmMid_r': None, 'pinky_01_side_inn_r': None, 'pinky_01_side_out_r': None, 'pinky_02_r': 'RightHandPinky3', 'pinky_02_bulge_r': None, 'pinky_02_half_r': None, 'pinky_02_in_r': None, 'pinky_02_pip_r': None, 'pinky_02_side_inn_r': None, 'pinky_02_side_out_r': None, 'pinky_03_r': 'RightHandPinky4', 'pinky_03_bulge_r': None, 'pinky_03_half_r': None, 'pinky_02_dip_r': None, 'pinky_03_in_r': None, 'pinky_metacarpal_slide_r': None, 'ring_metacarpal_r': 'RightHandRing1', 'ring_01_r': 'RightHandRing2', 'ring_01_bulge_r': None, 'ring_01_half_r': None, 'ring_01_mcp_r': None, 'ring_01_palm_r': None, 'ring_01_palmMid_r': None, 'ring_01_side_inn_r': None, 'ring_01_side_out_r': None, 'ring_02_r': 'RightHandRing3', 'ring_02_bulge_r': None, 'ring_02_half_r': None, 'ring_02_in_r': None, 'ring_02_pip_r': None, 'ring_02_side_inn_r': None, 'ring_02_side_out_r': None, 'ring_03_r': 'RightHandRing4', 'ring_03_bulge_r': None, 'ring_03_half_r': None, 'ring_02_dip_r': None, 'ring_03_in_r': None, 'ring_metacarpal_slide_r': None, 'thumb_01_r': 'RightHandThumb1', 'thumb_01_side_inn_r': None, 'thumb_01_side_out_r': None, 'thumb_02_r': 'RightHandThumb2', 'thumb_02_bulge_r': None, 'thumb_02_half_r': None, 'thumb_02_in_r': None, 'thumb_02_mcp_r': None, 'thumb_02_side_inn_r': None, 'thumb_02_side_out_r': None, 'thumb_03_r': 'RightHandThumb3', 'thumb_03_bulge_r': None, 'thumb_03_half_r': None, 'thumb_03_in_r': None, 'thumb_03_pip_r': None, 'thumb_03_side_inn_r': None, 'thumb_03_side_out_r': None, 'wrist_inner_r': None, 'wrist_outer_r': None, 'lowerarm_correctiveRoot_r': None, 'lowerarm_bck_r': None, 'lowerarm_fwd_r': None, 'lowerarm_in_r': None, 'lowerarm_out_r': None, 'lowerarm_twist_01_r': None, 'lowerarm_twist_02_r': None, 'upperarm_correctiveRoot_r': None, 'upperarm_bck_r': None, 'upperarm_fwd_r': None, 'upperarm_in_r': None, 'upperarm_out_r': None, 'upperarm_twist_01_r': None, 'upperarm_twistCor_01_r': None, 'upperarm_twist_02_r': None, 'upperarm_bicep_r': None, 'upperarm_tricep_r': None, 'upperarm_twistCor_02_r': None, 'spine_04_latissimus_l': None, 'spine_04_latissimus_r': None, 'thigh_l': 'LeftUpLeg', 'calf_l': 'LeftLeg', 'calf_correctiveRoot_l': None, 'calf_kneeBack_l': None, 'calf_knee_l': None, 'calf_twist_01_l': None, 'calf_twist_02_l': None, 'calf_twistCor_02_l': None, 'foot_l': 'LeftFoot', 'ankle_bck_l': None, 'ankle_fwd_l': None, 'ball_l': 'LeftToeBase', 'bigtoe_01_l': None, 'bigtoe_02_l': None, 'indextoe_01_l': None, 'indextoe_02_l': None, 'littletoe_01_l': None, 'littletoe_02_l': None, 'middletoe_01_l': None, 'middletoe_02_l': None, 'ringtoe_01_l': None, 'ringtoe_02_l': None, 'thigh_correctiveRoot_l': 'LeftToe_End', 'thigh_bck_l': None, 'thigh_bck_lwr_l': None, 'thigh_fwd_l': None, 'thigh_fwd_lwr_l': None, 'thigh_in_l': None, 'thigh_out_l': None, 'thigh_twist_01_l': None, 'thigh_twistCor_01_l': None, 'thigh_twist_02_l': None, 'thigh_twistCor_02_l': None, 'thigh_r': 'RightUpLeg', 'calf_r': 'RightLeg', 'calf_correctiveRoot_r': None, 'calf_kneeBack_r': None, 'calf_knee_r': None, 'calf_twist_01_r': None, 'calf_twist_02_r': None, 'calf_twistCor_02_r': None, 'foot_r': 'RightFoot', 'ankle_bck_r': None, 'ankle_fwd_r': None, 'ball_r': 'RightToeBase', 'bigtoe_01_r': 'RightToe_End', 'bigtoe_02_r': None, 'indextoe_01_r': None, 'indextoe_02_r': None, 'littletoe_01_r': None, 'littletoe_02_r': None, 'middletoe_01_r': None, 'middletoe_02_r': None, 'ringtoe_01_r': None, 'ringtoe_02_r': None, 'thigh_correctiveRoot_r': None, 'thigh_bck_lwr_r': None, 'thigh_bck_r': None, 'thigh_fwd_lwr_r': None, 'thigh_fwd_r': None, 'thigh_in_r': None, 'thigh_out_r': None, 'thigh_twist_01_r': None, 'thigh_twistCor_01_r': None, 'thigh_twist_02_r': None, 'thigh_twistCor_02_r': None}